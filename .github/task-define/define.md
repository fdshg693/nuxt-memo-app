# タスク定義書

## プロジェクト概要
Nuxt 3ベースのインタラクティブSQL学習プラットフォームの機能拡張

## 実装対象の4つの主要機能

### 1. AIプロンプトシステムの改善
**目標**: より柔軟で実用的なAIプロンプト機能の実現

**具体的な実装内容:**
- プルダウン選択だけでなく、自由テキスト入力フィールドの追加
- 既存の説明文章（sqlExplanation/）を動的に組み込める仕組み
- プロンプトテンプレートの管理機能
- コンテキストに応じた適応型プロンプト生成

**影響コンポーネント:**
- `AiPromptModal.vue` - メインUI改修
- `/data/sqlExplanation/` - 既存説明文章の活用
- `/server/api/openai.post.ts` - プロンプト処理ロジック

### 2. AI自動問題生成機能
**目標**: 既存テーブル定義を活用したSQL問題の自動生成

**具体的な実装内容:**
- 既存データベース定義（sqlDatabases.json）を解析してAI問題生成
- 生成された問題の自動検証システム
- 問題難易度の自動判定機能
- 生成問題の保存・管理機能

**新規実装が必要な項目:**
- AI問題生成用の新しいエンドポイント
- 問題生成用のUIコンポーネント
- 生成問題の管理画面

### 3. Markdown回答表示システム
**目標**: AI回答の可読性向上とリッチな表示

**具体的な実装内容:**
- Markdownレンダリングライブラリの導入
- SQLコードハイライト機能
- 表形式データの整形表示
- 適切なスタイリングの適用

**技術選択肢:**
- `@nuxt/content`モジュール または `markdown-it`
- `highlight.js` for SQLシンタックスハイライト

### 4. 実践的SQL問題の追加
**目標**: 理論的な知識を問う選択式問題の追加

**具体的な実装内容:**
- TRANSACTION関連問題（分離レベル、ロック、コミット/ロールバック）
- パフォーマンス関連問題（インデックス、クエリ最適化、実行計画）
- DEAD LOCK関連問題（発生原因、回避策、対処法）

**新しいデータ構造:**
- 選択式問題用の新しいJSONスキーマ
- 問題タイプ判定システム
- 選択肢管理と正解判定ロジック

## 実装優先順位と段階分け

### Phase 1: 基盤機能の実装
1. Markdownレンダリングシステムの導入
2. AIプロンプトシステムの改善

### Phase 2: 新機能の実装
3. 選択式問題システムの構築
4. AI自動問題生成機能

### Phase 3: 統合とテスト
5. 全機能の統合とテスト
6. UIの最適化とブラッシュアップ

## 技術的実装詳細

### データ構造の拡張
```json
// 選択式問題用の新しいスキーマ
{
  "id": "practical-001",
  "type": "multiple-choice",
  "category": "transaction",
  "level": 4,
  "question": "ACID特性のうち...",
  "choices": ["A", "B", "C", "D"],
  "correct": 0,
  "explanation": "..."
}
```

### コンポーネント設計
- `MultipleChoiceQuestion.vue` - 選択式問題用コンポーネント
- `AiQuestionGenerator.vue` - AI問題生成UI
- `MarkdownRenderer.vue` - Markdown表示コンポーネント
- `EnhancedAiPrompt.vue` - 改良版AIプロンプト

### API拡張
- `/server/api/generate-question.post.ts` - AI問題生成
- `/server/api/save-question.post.ts` - 生成問題保存

## ユーザビリティ向上ポイント

### 学習体験の向上
- AI回答の視認性向上（Markdown対応）
- より自然なAI対話体験
- 段階的な学習フロー（基礎→応用→実践）

### 教育効果の最大化
- コンテキスト適応型のヒント提供
- 既存説明文章の効果的活用
- 実践的なシナリオベース問題

## 成功指標
1. AIプロンプトの自由度向上とユーザー満足度
2. 自動生成問題の品質と多様性
3. Markdown表示による回答の可読性向上
4. 実践的問題による学習効果の向上
